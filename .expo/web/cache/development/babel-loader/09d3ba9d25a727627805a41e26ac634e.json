{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport { useRoute } from '@react-navigation/native';\nimport React, { useEffect, useState } from 'react';\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { auth, firestore } from \"../firebase\";\nimport { GiftedChat } from 'react-native-gifted-chat';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nvar Chat = function Chat() {\n  var route = useRoute();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      messages = _useState2[0],\n      setMessages = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      uid = _useState4[0],\n      setUid = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      name = _useState6[0],\n      setName = _useState6[1];\n\n  useEffect(function () {\n    return firestore.doc('chats/' + route.params.chatId).onSnapshot(function (s) {\n      var _s$data$messages, _s$data;\n\n      setMessages((_s$data$messages = (_s$data = s.data()) == null ? void 0 : _s$data.messages) != null ? _s$data$messages : []);\n      console.log(messages);\n    });\n  }, [route.params.chatId]);\n  useEffect(function () {\n    return auth.onAuthStateChanged(function (user) {\n      setUid(user == null ? void 0 : user.uid);\n      setName(user == null ? void 0 : user.displayName);\n    });\n  }, []);\n\n  var _onSend = function onSend() {\n    var m = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    firestore.doc('chats/' + route.params.chatId).set({\n      messages: GiftedChat.append(messages, m)\n    }, {\n      merge: true\n    });\n  };\n\n  return _jsx(View, {\n    style: {\n      flex: 1,\n      backgroundColor: 'white'\n    },\n    children: _jsx(GiftedChat, {\n      messages: messages.map(function (x) {\n        var _x$createdAt;\n\n        return _objectSpread(_objectSpread({}, x), {}, {\n          createdAt: x == null ? void 0 : (_x$createdAt = x.createdAt) == null ? void 0 : _x$createdAt.toDate()\n        });\n      }),\n      onSend: function onSend(messages) {\n        return _onSend(messages);\n      },\n      user: {\n        _id: uid,\n        name: name\n      }\n    })\n  });\n};\n\nexport default Chat;","map":{"version":3,"names":["useRoute","React","useEffect","useState","auth","firestore","GiftedChat","Chat","route","messages","setMessages","uid","setUid","name","setName","doc","params","chatId","onSnapshot","s","data","console","log","onAuthStateChanged","user","displayName","onSend","m","set","append","merge","flex","backgroundColor","map","x","createdAt","toDate","_id"],"sources":["C:/ChattApp/screens/Chat.js"],"sourcesContent":["import { useRoute } from '@react-navigation/native'\r\nimport React,{useEffect,useState} from 'react'\r\nimport { Text,View } from 'react-native'\r\nimport { auth, firestore } from '../firebase';\r\nimport { GiftedChat } from 'react-native-gifted-chat';\r\n\r\nconst Chat=()=>{\r\n    const route=useRoute();\r\n    // console.log(\"*****************\")\r\n    // console.log(route.params.chatId)\r\n\r\n    const[messages,setMessages]=useState([]);\r\n    const[uid,setUid]=useState('');\r\n    const[name,setName]=useState('');\r\n\r\n    useEffect(()=>{\r\n        return firestore.doc('chats/'+route.params.chatId).onSnapshot((s)=>{\r\n            setMessages(s.data()?.messages ?? []);\r\n            console.log(messages)\r\n        })\r\n    },[route.params.chatId])\r\n\r\n    useEffect(()=>{\r\n      return auth.onAuthStateChanged((user)=>{\r\n        setUid(user?.uid);\r\n        setName(user?.displayName)\r\n       })\r\n    },[])\r\n\r\n    const onSend = (m = []) => {\r\n        firestore\r\n        .doc('chats/'+route.params.chatId)\r\n        .set({\r\n            messages:GiftedChat.append(messages, m),\r\n        },{merge:true}) \r\n      }\r\n\r\n    return(\r\n        <View style={{flex:1,backgroundColor:'white'}}>\r\n        <GiftedChat\r\n            messages={messages.map(x=>({...x,createdAt:x?.createdAt?.toDate()}))}\r\n            onSend={messages => onSend(messages)}\r\n            user={{\r\n                _id: uid,\r\n                name:name,\r\n            }}\r\n        />\r\n        </View>\r\n    )\r\n}\r\n\r\nexport default Chat;"],"mappings":";;;;;;;AAAA,SAASA,QAAT,QAAyB,0BAAzB;AACA,OAAOC,KAAP,IAAcC,SAAd,EAAwBC,QAAxB,QAAuC,OAAvC;;;AAEA,SAASC,IAAT,EAAeC,SAAf;AACA,SAASC,UAAT,QAA2B,0BAA3B;;;AAEA,IAAMC,IAAI,GAAC,SAALA,IAAK,GAAI;EACX,IAAMC,KAAK,GAACR,QAAQ,EAApB;;EAIA,gBAA4BG,QAAQ,CAAC,EAAD,CAApC;EAAA;EAAA,IAAMM,QAAN;EAAA,IAAeC,WAAf;;EACA,iBAAkBP,QAAQ,CAAC,EAAD,CAA1B;EAAA;EAAA,IAAMQ,GAAN;EAAA,IAAUC,MAAV;;EACA,iBAAoBT,QAAQ,CAAC,EAAD,CAA5B;EAAA;EAAA,IAAMU,IAAN;EAAA,IAAWC,OAAX;;EAEAZ,SAAS,CAAC,YAAI;IACV,OAAOG,SAAS,CAACU,GAAV,CAAc,WAASP,KAAK,CAACQ,MAAN,CAAaC,MAApC,EAA4CC,UAA5C,CAAuD,UAACC,CAAD,EAAK;MAAA;;MAC/DT,WAAW,gCAACS,CAAC,CAACC,IAAF,EAAD,qBAAC,QAAUX,QAAX,+BAAuB,EAAvB,CAAX;MACAY,OAAO,CAACC,GAAR,CAAYb,QAAZ;IACH,CAHM,CAAP;EAIH,CALQ,EAKP,CAACD,KAAK,CAACQ,MAAN,CAAaC,MAAd,CALO,CAAT;EAOAf,SAAS,CAAC,YAAI;IACZ,OAAOE,IAAI,CAACmB,kBAAL,CAAwB,UAACC,IAAD,EAAQ;MACrCZ,MAAM,CAACY,IAAD,oBAACA,IAAI,CAAEb,GAAP,CAAN;MACAG,OAAO,CAACU,IAAD,oBAACA,IAAI,CAAEC,WAAP,CAAP;IACA,CAHK,CAAP;EAID,CALQ,EAKP,EALO,CAAT;;EAOA,IAAMC,OAAM,GAAG,SAATA,MAAS,GAAY;IAAA,IAAXC,CAAW,uEAAP,EAAO;IACvBtB,SAAS,CACRU,GADD,CACK,WAASP,KAAK,CAACQ,MAAN,CAAaC,MAD3B,EAECW,GAFD,CAEK;MACDnB,QAAQ,EAACH,UAAU,CAACuB,MAAX,CAAkBpB,QAAlB,EAA4BkB,CAA5B;IADR,CAFL,EAIE;MAACG,KAAK,EAAC;IAAP,CAJF;EAKD,CANH;;EAQA,OACI,KAAC,IAAD;IAAM,KAAK,EAAE;MAACC,IAAI,EAAC,CAAN;MAAQC,eAAe,EAAC;IAAxB,CAAb;IAAA,UACA,KAAC,UAAD;MACI,QAAQ,EAAEvB,QAAQ,CAACwB,GAAT,CAAa,UAAAC,CAAC;QAAA;;QAAA,uCAAOA,CAAP;UAASC,SAAS,EAACD,CAAD,oCAACA,CAAC,CAAEC,SAAJ,qBAAC,aAAcC,MAAd;QAAnB;MAAA,CAAd,CADd;MAEI,MAAM,EAAE,gBAAA3B,QAAQ;QAAA,OAAIiB,OAAM,CAACjB,QAAD,CAAV;MAAA,CAFpB;MAGI,IAAI,EAAE;QACF4B,GAAG,EAAE1B,GADH;QAEFE,IAAI,EAACA;MAFH;IAHV;EADA,EADJ;AAYH,CA3CD;;AA6CA,eAAeN,IAAf"},"metadata":{},"sourceType":"module"}